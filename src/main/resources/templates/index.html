<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>时代在线</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">
    <link rel="stylesheet" href="../static/css/me.css" th:href="@{/css/me.css}">
</head>
<body>
<!--导航-->
<nav class="ui inverted attached segment m-padded-td-mini m-shadow-small">
    <div class="ui container">
        <div class="ui inverted secondary stackable menu">
            <h2 class="ui teal header item">时代在线</h2>
            <a href="#" class="active m-item item m-mobile-hide"><i class="home icon"></i>首页</a>
            <div class="right menu m-item m-mobile-hide">
                <div class="ui dropdown item">
                    <div class="text">
                        <img class="ui avatar image" src="https://picsum.photos/id/112/400/400">Username01
                    </div>
                    <i class="dropdown icon"></i>
                    <div class="menu">
                        <a href="#" class="item" th:href="@{/logout}"><i class="sign-out icon"></i>注销</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <a href="#" class="ui menu toggle button black m-right-top m-mobile-show">
        <i class="sidebar icon"></i>
    </a>
</nav>
<!--中间内容-->
<div class="m-padded-tb-big m-container">
    <div class="ui container">
        <div class="ui grid">
            <!--左-->
            <!-左侧的列-->
            <div class="four wide column">
                <!-搜索--->
                <div class="ui segments">
                    <div class="ui secondary segment">
                        <div class="ui column grid">
                            <div class="column">
                                <i class="idea icon"></i>查询
                            </div>
                        </div>
                    </div>
                    <div class="ui teal segment center aligned">
                        <div class="ui  search dropdown  selection dropdown">
                            <input type="hidden">
                            <i class="dropdown icon"></i>
                            <div class="default text">查询的知识点</div>
                            <div class="menu">
                                <div class="item" data-value="1" th:each="c:${zhishidianList}" th:text="${c}">
                                    三角形
                                </div>
                                <!--/*-->
                                <div class="item" data-value="1">
                                    四边形
                                </div>
                                <!--*/-->
                            </div>
                        </div>
                        <div class="ui button" id="search" onclick="search()">
                            查询
                        </div>
                    </div>
                </div>
            </div>

            <!-右侧的top-->
            <div class="twelve wide column">
                <!--header-->
                <div class="ui segment top attached">
                    <div class="ui grid  column center aligned">
                        <div class="column">
                            <h2 class="ui teal header">图形展示</h2>
                        </div>
                    </div>
                </div>
                <!--content--->
                <div class="ui attached segment">
                    <!--<div class="ui padded  segment vertical  m-padded-tb-big">-->
                    <div class="ui padded  segment vertical  m-padded-tb-big">
                        <!--<div class="ui middle aligned mobile reversed stackable grid">
                            <div class="eleven wide column">
                                <h3 class="ui header">
                                    <a href="#" th:href="@{/login/student/doing/{id}(id=${publish.id})}" class="m-black"
                                       th:text="${publish.note}">2020.4.1
                                        数学作业 </a><label
                                        th:text="${publish.statusList[0].status}?'(已完成)':'(未完成)'"></label>
                                </h3>
                                <p class="m-text" th:text="'开始时间:'+${publish.starttime}">开始时间：2020.4.2 12：00</p>
                                <p class="m-text" th:text="'截止时间:'+${publish.endtime}">完成截止时间：2020.4.2 12：00</p>
                                <br>
                                <div class="ui grid">
                                    <div class="eleven wide column">
                                        <div class="ui link list mini horizontal">
                                            <div class="item">
                                                <h5 class="content">发布者:</h5>
                                            </div>
                                            <div class="item">
                                                <img src="https://picsum.photos/id/1/100/100" alt=""
                                                     class="ui avatar image">
                                                <div class="content">
                                                    <a href="#" class="header" th:text="${publish.username}">数学老师1</a>
                                                </div>
                                            </div>
                                            <div class="item">
                                                <i class="calendar icon"></i>
                                                <span th:text="${#dates.format(publish.updatetime,'yyyy-MM-dd')}">2020.4.1</span>
                                            </div>
                                            <div class="item">
                                                <i class="eye icon"></i>200
                                            </div>
                                            <div class="item">
                                                <span th:text="${publish.course.coursename}"></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="right aligned five wide column">
                                        <a href="#" target="" th:href="@{/login/student/doing/{id}(id=${publish.id})}"
                                           class="ui teal basic label m-padded-td-tiny">任务详情</a>
                                    </div>
                                </div>
                            </div>
                            <div class="five wide column">
                                <a href="#" target="_blank">
                                    <img src="https://picsum.photos/id/1/800/450" alt="" class="ui rounded image">
                                </a>
                            </div>
                        </div>-->
                        <div class="ui middle aligned mobile reversed stackable grid">
                            <div id="dom" style="width: 880px; height: 750px; float: left;"></div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<br>
<br>

<!--底部footer-->
<footer class="ui inverted segment vertical m-padded-tb-massive">
    <div class="ui center aligned container">
        <div class="ui grid divided stackable inverted">
            <div class="three wide  column">
                <h4 class="ui inverted header">111</h4>
            </div>
            <div class="three wide  column">
                <h4 class="ui inverted header">111</h4>
            </div>
            <div class="three wide  column">
                <h4 class="ui inverted header">111</h4>
            </div>
            <div class="seven wide column">
                <h4 class="ui inverted header">111</h4>
                <p>希望。。。。。。</p>
            </div>
        </div>
        <div class="ui inverted section divider"></div>
        <p class="m-text-thin m-text-spaced">个人网站</p>
    </div>
</footer>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.2/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/semantic-ui/2.2.4/semantic.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/echarts@4.7.0/dist/echarts.js"></script>
<!--<script type="text/javascript" src="../../static/js/echarts4.js" th:src="@{/js/echarts4.js}"></script>-->
<!--
<script type="text/javascript">
    // 基于准备好的dom，初始化echarts实例
    var myChart = echarts.init(document.getElementById('main1'));
    // 指定图表的配置项和数据

    var option = {
        title: {
            left: 'center',
            text: '作业完成情况',
            top: 20,
            textStyle: {
                color: '#611',
            }
        },
        xAxis: {
            type: 'category',
            name: '时间',
            data: ['2020.4.1', '2020.4.2', '2020.4.3', '2020.4.4', '2020.4.5', '2020.4.6', '2020.4.7']
        },
        yAxis: {
            type: 'value'
        },
        series: [{
            data: [120, 200, 150, 80, 70, 110, 130],
            type: 'bar',
            showBackground: true,
            backgroundStyle: {
                color: 'rgba(220, 220, 220, 0.8)'
            }
        }]
    };

    // 使用刚指定的配置项和数据显示图表。
    myChart.setOption(option);
</script>
-->
<!--
<script type="text/javascript">
    // 基于准备好的dom，初始化echarts实例
    // var myChart = echarts.init(document.getElementById('main1'));
    var myChart = echarts.init(document.getElementById('dom'));
    $.post("/xiongdi", function (result) {
        console.log(1);
        var categories = [];
        categories[0] = {
            name: '当前搜索'
        };
        categories[1] = {
            name: '兄弟关系实例'
        };
        categories[2] = {
            name: '前继后继关系实例'
        };
        categories[3] = {
            name: '直接关系实例'
        };
        /* for (var i = 0; i < 3; i++) {
            categories[i] = {
                name: '类目' + i
            };
        } */
        option = {
            // 图的标题
            title: {
                text: 'ECharts 关系图'
            },
            // 提示框的配置
            tooltip: {
                formatter: function (x) {
                    return x.data.des;
                }
            },
            // 工具箱
            toolbox: {
                // 显示工具箱
                show: true,
                feature: {
                    mark: {
                        show: true
                    },
                    // 还原
                    restore: {
                        show: true
                    },
                    // 保存为图片
                    saveAsImage: {
                        show: true
                    }
                }
            },
            legend: [{
                // selectedMode: 'single',
                data: categories.map(function (a) {
                    return a.name;
                })
            }],
            series: [{
                type: 'graph', // 类型:关系图
                layout: 'force', //图的布局，类型为力导图
                symbolSize: 40, // 调整节点的大小
                roam: true, // 是否开启鼠标缩放和平移漫游。默认不开启。如果只想要开启缩放或者平移,可以设置成 'scale' 或者 'move'。设置成 true 为都开启
                legendHoverLink: true,//是否启用图例 hover(悬停) 时的联动高亮。
                hoverAnimation: false,//是否开启鼠标悬停节点的显示动画
                edgeSymbol: ['circle', 'arrow'],
                edgeSymbolSize: [2, 10],
                edgeLabel: {
                    normal: {
                        textStyle: {
                            fontSize: 20
                        }
                    }
                },
                force: {
                    repulsion: 3000,
                    edgeLength: [10, 50],
                    layoutAnimation: false,//因为力引导布局会在多次迭代后才会稳定，这个参数决定是否显示布局的迭代动画，在浏览器端节点数据较多（>100）的时候不建议关闭，布局过程会造成浏览器假死。
                },
                draggable: true,
                //focusNodeAdjacency : true,
                lineStyle: {
                    normal: {
                        width: 4,
                        color: '#4b565b',
                    }
                },
                edgeLabel: {
                    normal: {
                        show: true,
                        formatter: function (x) {
                            return x.data.name;
                        }
                    }
                },
                label: {
                    normal: {
                        show: true,
                        textStyle: {}
                    }
                },

                // 数据

                data: result.NOTE,

                links: result.LINK,
                /*
                links: [{
                 source: 'node01',
                 target: 'node02',
                 name: 'link01',
                 des: 'link01des'
                 }], */
                categories: categories,
            }]
        };

        /* setTimeout(()=> {
        myChart.setOption(option);
        }, 500) ; */
        echarts.init(document.getElementById('dom')).dispose();//销毁前一个实例
        var myChart = echarts.init(document
            .getElementById('dom'));//构建下一个实例
        myChart.setOption(option);
        myChart.on('click', function (params) {
            clickzhi = params.name;
            click();
        });
    }, "JSON");
</script>
-->

<script>
    function search() {
        $.ajax({
            url: "/xiongdi",
            data: {name: 'jenny'},
            type: "POST",
            dataType: "json",
            success: function (result) {
                var NOTEs = result["NOTE"];
                var LINKs = result["LINK"];
                console.log(result.NOTE,result.LINK);
                // datas = jQuery.parseJSON(r);  //dataType指明了返回数据为json类型，故不需要再反序列化
                var myChart = echarts.init(document.getElementById('dom'));
                var categories = [];
                categories[0] = {
                    name: '当前搜索'
                };
                categories[1] = {
                    name: '兄弟关系实例'
                };
                categories[2] = {
                    name: '前继后继关系实例'
                };
                categories[3] = {
                    name: '直接关系实例'
                };
                /* for (var i = 0; i < 3; i++) {
                categories[i] = {
                    name: '类目' + i
                };
            } */
                option = {
                    // 图的标题
                    title: {
                        text: ''
                    },
                    // 提示框的配置
                    tooltip: {
                        formatter: function (x) {
                            return x.des;
                        }
                    },
                    // 工具箱
                    toolbox: {
                        // 显示工具箱
                        show: true,
                        feature: {
                            mark: {
                                show: true
                            },
                            // 还原
                            restore: {
                                show: true
                            },
                            // 保存为图片
                            saveAsImage: {
                                show: true
                            }
                        }
                    },
                    /*legend: [{
                        // selectedMode: 'single',
                        data: categories.map(function (a) {
                            return a.name;
                        })
                    }],*/
                    series: [{
                        type: 'graph', // 类型:关系图
                        layout: 'force', //图的布局，类型为力导图
                        symbolSize: 40, // 调整节点的大小
                        roam: true, // 是否开启鼠标缩放和平移漫游。默认不开启。如果只想要开启缩放或者平移,可以设置成 'scale' 或者 'move'。设置成 true 为都开启
                        legendHoverLink: true,//是否启用图例 hover(悬停) 时的联动高亮。
                        hoverAnimation: false,//是否开启鼠标悬停节点的显示动画
                        edgeSymbol: ['circle', 'arrow'],
                        edgeSymbolSize: [2, 10],
                        edgeLabel: {
                            normal: {
                                textStyle: {
                                    fontSize: 20
                                }
                            }
                        },
                        force: {
                            repulsion: 3000,
                            edgeLength: [10, 50],
                            layoutAnimation: false,//因为力引导布局会在多次迭代后才会稳定，这个参数决定是否显示布局的迭代动画，在浏览器端节点数据较多（>100）的时候不建议关闭，布局过程会造成浏览器假死。
                        },
                        draggable: true,
                        //focusNodeAdjacency : true,
                        lineStyle: {
                            normal: {
                                width: 4,
                                color: '#4b565b',
                            }
                        },
                        edgeLabel: {
                            normal: {
                                show: true,
                                formatter: function (x) {
                                    return x.name;
                                }
                            }
                        },
                        label: {
                            normal: {
                                show: true,
                                textStyle: {}
                            }
                        },
                        // 数据
                        data: result.NOTE,
                        links: result.LINK,
                        /*
                    links: [{
                     source: 'node01',
                     target: 'node02',
                     name: 'link01',
                     des: 'link01des'
                     }], */
                        categories: categories,
                    }]
                };

                /* setTimeout(()=> {
            myChart.setOption(option);
            }, 500) ; */
           /*     echarts.init(document.getElementById('dom')).dispose();//销毁前一个实例
                var myChart = echarts.init(document.getElementById('dom'));//构建下一个实例*/
                myChart.setOption(option);
               /* myChart.on('click', function (params) {
                    var clickzhi = params.name;
                });*/
            }
        });

       /* function load() {
            /!* 创建XMLHttpRequest对象 *!/
            if (window.XMLHttpRequest) {
                xhr = new XMLHttpRequest();
            } else {
                xhr = new ActiveObject("Microsoft.XMLHTTP");
            }
            xhr.onreadystatechange = function () {
                if (xhr.readyState == 4) {

                    if (xhr.status == 200) {//表示服务器正常
                        //请求link数据，重新发送ajax请求
                        /!*  *!/
                        var jsonString = xhr.responseText;
                        eval("var data=" + jsonString);
                        //doucument.getElementById("dom").innerHTML = jsonString;
                        /!* 						var hello;
                     if (radio == 1) {
                     hello = "<h3>兄弟实例查询</h3>"
                     }
                     if (radio == 2) {
                     hello = "<h3>前继、后继实例查询</h3>"
                     }
                     if (radio == 3) {
                     hello = "<h3>知识点间关系展示查询</h3>"
                     }
                     document.getElementById("msg").innerHTML =hello; *!/

                        /!* 测试 *!/
                        var myChart = echarts.init(document
                            .getElementById('dom'));
                        var categories = [];
                        categories[0] = {
                            name: '当前搜索'
                        };
                        categories[1] = {
                            name: '兄弟关系实例'
                        };
                        categories[2] = {
                            name: '前继后继关系实例'
                        };
                        categories[3] = {
                            name: '直接关系实例'
                        };
                        /!* for (var i = 0; i < 3; i++) {
                        categories[i] = {
                            name: '类目' + i
                        };
                    } *!/
                        option = {
                            // 图的标题
                            title: {
                                text: 'ECharts 关系图'
                            },
                            // 提示框的配置
                            tooltip: {
                                formatter: function (x) {
                                    return x.data.des;
                                }
                            },
                            // 工具箱
                            toolbox: {
                                // 显示工具箱
                                show: true,
                                feature: {
                                    mark: {
                                        show: true
                                    },
                                    // 还原
                                    restore: {
                                        show: true
                                    },
                                    // 保存为图片
                                    saveAsImage: {
                                        show: true
                                    }
                                }
                            },
                            legend: [{
                                // selectedMode: 'single',
                                data: categories.map(function (a) {
                                    return a.name;
                                })
                            }],
                            series: [{
                                type: 'graph', // 类型:关系图
                                layout: 'force', //图的布局，类型为力导图
                                symbolSize: 40, // 调整节点的大小
                                roam: true, // 是否开启鼠标缩放和平移漫游。默认不开启。如果只想要开启缩放或者平移,可以设置成 'scale' 或者 'move'。设置成 true 为都开启
                                legendHoverLink: true,//是否启用图例 hover(悬停) 时的联动高亮。
                                hoverAnimation: false,//是否开启鼠标悬停节点的显示动画
                                edgeSymbol: ['circle', 'arrow'],
                                edgeSymbolSize: [2, 10],
                                edgeLabel: {
                                    normal: {
                                        textStyle: {
                                            fontSize: 20
                                        }
                                    }
                                },
                                force: {
                                    repulsion: 3000,
                                    edgeLength: [10, 50],
                                    layoutAnimation: false,//因为力引导布局会在多次迭代后才会稳定，这个参数决定是否显示布局的迭代动画，在浏览器端节点数据较多（>100）的时候不建议关闭，布局过程会造成浏览器假死。
                                },
                                draggable: true,
                                //focusNodeAdjacency : true,
                                lineStyle: {
                                    normal: {
                                        width: 4,
                                        color: '#4b565b',
                                    }
                                },
                                edgeLabel: {
                                    normal: {
                                        show: true,
                                        formatter: function (x) {
                                            return x.data.name;
                                        }
                                    }
                                },
                                label: {
                                    normal: {
                                        show: true,
                                        textStyle: {}
                                    }
                                },

                                // 数据

                                data: data,

                                links: link,
                                /!*
                            links: [{
                             source: 'node01',
                             target: 'node02',
                             name: 'link01',
                             des: 'link01des'
                             }], *!/
                                categories: categories,
                            }]
                        };

                        /!* setTimeout(()=> {
                    myChart.setOption(option);
                    }, 500) ; *!/
                        echarts.init(document.getElementById('dom')).dispose();//销毁前一个实例
                        var myChart = echarts.init(document
                            .getElementById('dom'));//构建下一个实例
                        myChart.setOption(option);
                        myChart.on('click', function (params) {
                            clickzhi = params.name;
                            click();
                        });
                    } else {
                        //弹出出错的状态代码
                        alert(xhr.status);
                    }
                }
            }
            /!* post提交方式-------字符定为UFT-8 *!/
            xhr.open("POST", "tx.do", true);
            xhr.setRequestHeader("Content-type",
                "application/x-www-form-urlencoded;charset=UTF-8");
            /!* 发送AJAX请求 *!/

            if (clickzhi != null) {
                zhi = clickzhi;
                clickzhi = null;
            }
            xhr.send("zhi=" + zhi + "&radio=" + radio);
        }*/
    }
</script>

<script>
    $(".menu.toggle").click(function () {
        $(".m-item").toggleClass("m-mobile-hide");
    });
    $('.ui.dropdown').dropdown({
        on: 'hover'//鼠标移上去就触发
    });
</script>
</body>
</html>